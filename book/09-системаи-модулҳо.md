# Боби 9: Системаи модулҳо

## 9.1. Муқаддима ба модулҳо

Модулҳо имкон медиҳанд, ки кодро ба қисмҳои ҷудогона тақсим кунед ва дар файлҳои гуногун нигоҳ доред. Ин кодро мураттаб, аз нав истифодашаванда ва осон барои идоракунӣ мегардонад.

## 9.2. Содир кардан (Export)

### 9.2.1. Содири оддӣ

```somonscript
// math-utils.som
содир функсия ҷамъ(а: рақам, б: рақам): рақам {
    бозгашт а + б;
}

содир функсия зарб(а: рақам, б: рақам): рақам {
    бозгашт а * б;
}

содир собит ПИ: рақам = 3.14159;
```

### 9.2.2. Содири якҷояи чанд элемент

```somonscript
// string-utils.som
функсия калон_кардан(сатр: сатр): сатр {
    бозгашт сатр.toUpperCase();
}

функсия хурд_кардан(сатр: сатр): сатр {
    бозгашт сатр.toLowerCase();
}

функсия баръакс_кардан(сатр: сатр): сатр {
    бозгашт сатр.split('').reverse().join('');
}

// Содири якҷоя
содир { калон_кардан, хурд_кардан, баръакс_кардан };
```

### 9.2.3. Содири пешфарз

```somonscript
// calculator.som
функсия ҳисоб_кардан(а: рақам, б: рақам, амал: сатр): рақам {
    интихоб (амал) {
        ҳолат "+": бозгашт а + б;
        ҳолат "-": бозгашт а - б;
        ҳолат "*": бозгашт а * б;
        ҳолат "/": бозгашт а / б;
        пешфарз: бозгашт 0;
    }
}

содир пешфарз ҳисоб_кардан;
```

## 9.3. Ворид кардан (Import)

### 9.3.1. Вориди оддӣ

```somonscript
// main.som
ворид { ҷамъ, зарб, ПИ } аз "./math-utils.som";

тағйирёбанда натиҷа: рақам = ҷамъ(10, 20);
чоп.сабт("Ҷамъ: " + натиҷа);  // 30

чоп.сабт("ПИ: " + ПИ);  // 3.14159
```

### 9.3.2. Вориди пешфарз

```somonscript
// main.som
ворид ҳисоб_кардан аз "./calculator.som";

тағйирёбанда натиҷа: рақам = ҳисоб_кардан(10, 5, "+");
чоп.сабт(натиҷа);  // 15
```

### 9.3.3. Вориди ҳамаи чиз

```somonscript
// main.som
ворид * чун математика аз "./math-utils.som";

чоп.сабт(математика.ҷамъ(5, 3));  // 8
чоп.сабт(математика.ПИ);  // 3.14159
```

### 9.3.4. Вориди бо номи дигар

```somonscript
// main.som
ворид { ҷамъ чун ҷамъ_кардан, зарб чун зарб_кардан } аз "./math-utils.som";

чоп.сабт(ҷамъ_кардан(10, 20));  // 30
чоп.сабт(зарб_кардан(5, 6));    // 30
```

## 9.4. Мисолҳои амалӣ

### Мисоли 1: Модули математикӣ

```somonscript
// math.som
содир собит ПИ: рақам = 3.14159;
содир собит Е: рақам = 2.71828;

содир функсия квадрат(х: рақам): рақам {
    бозгашт х * х;
}

содир функсия куб(х: рақам): рақам {
    бозгашт х * х * х;
}

содир функсия факториал(н: рақам): рақам {
    агар (н <= 1) бозгашт 1;
    бозгашт н * факториал(н - 1);
}

содир функсия дараҷа(асос: рақам, дараҷа: рақам): рақам {
    бозгашт асос ** дараҷа;
}
```

```somonscript
// main.som
ворид { квадрат, куб, факториал, дараҷа, ПИ } аз "./math.som";

чоп.сабт("Квадрати 5: " + квадрат(5));
чоп.сабт("Куби 3: " + куб(3));
чоп.сабт("Факториали 5: " + факториал(5));
чоп.сабт("2^8: " + дараҷа(2, 8));
чоп.сабт("ПИ: " + ПИ);
```

### Мисоли 2: Модули коркарди массивҳо

```somonscript
// array-utils.som
содир функсия калонтарин(массив: рақам[]): рақам {
    агар (массив.дарозӣ === 0) бозгашт 0;

    тағйирёбанда макс: рақам = массив[0];
    барои (тағйирёбанда и: рақам = 1; и < массив.дарозӣ; и++) {
        агар (массив[и] > макс) {
            макс = массив[и];
        }
    }
    бозгашт макс;
}

содир функсия хурдтарин(массив: рақам[]): рақам {
    агар (массив.дарозӣ === 0) бозгашт 0;

    тағйирёбанда мин: рақам = массив[0];
    барои (тағйирёбанда и: рақам = 1; и < массив.дарозӣ; и++) {
        агар (массив[и] < мин) {
            мин = массив[и];
        }
    }
    бозгашт мин;
}

содир функсия миёна(массив: рақам[]): рақам {
    агар (массив.дарозӣ === 0) бозгашт 0;

    тағйирёбанда ҷамъ: рақам = 0;
    барои (тағйирёбанда и: рақам = 0; и < массив.дарозӣ; и++) {
        ҷамъ += массив[и];
    }
    бозгашт ҷамъ / массив.дарозӣ;
}

содир функсия ҷамъи_ҳама(массив: рақам[]): рақам {
    тағйирёбанда ҷамъ: рақам = 0;
    барои (тағйирёбанда и: рақам = 0; и < массив.дарозӣ; и++) {
        ҷамъ += массив[и];
    }
    бозгашт ҷамъ;
}
```

```somonscript
// main.som
ворид { калонтарин, хурдтарин, миёна, ҷамъи_ҳама } аз "./array-utils.som";

тағйирёбанда ададҳо: рақам[] = [10, 25, 5, 30, 15, 20];

чоп.сабт("Массив: " + ададҳо);
чоп.сабт("Калонтарин: " + калонтарин(ададҳо));
чоп.сабт("Хурдтарин: " + хурдтарин(ададҳо));
чоп.сабт("Миёна: " + миёна(ададҳо));
чоп.сабт("Ҷамъи ҳама: " + ҷамъи_ҳама(ададҳо));
```

### Мисоли 3: Модули идораи корбарон

```somonscript
// user-manager.som
содир синф Корбар {
    хосусӣ ном: сатр;
    хосусӣ email: сатр;
    хосусӣ синну_сол: рақам;

    конструктор(ном: сатр, email: сатр, синну_сол: рақам) {
        ин.ном = ном;
        ин.email = email;
        ин.синну_сол = синну_сол;
    }

    ҷамъиятӣ гирифтани_ном(): сатр {
        бозгашт ин.ном;
    }

    ҷамъиятӣ гирифтани_email(): сатр {
        бозгашт ин.email;
    }

    ҷамъиятӣ намоиш(): холӣ {
        чоп.сабт(`Корбар: ${ин.ном} (${ин.email}) - ${ин.синну_сол} сол`);
    }
}

содир синф Идоракунандаи_корбарон {
    хосусӣ корбарон: Корбар[];

    конструктор() {
        ин.корбарон = [];
    }

    ҷамъиятӣ илова_кардан(корбар: Корбар): холӣ {
        ин.корбарон.илова(корбар);
        чоп.сабт(`Корбар ${корбар.гирифтани_ном()} илова карда шуд`);
    }

    ҷамъиятӣ намоиш(): холӣ {
        чоп.сабт("\n=== Рӯйхати корбарон ===");
        барои (тағйирёбанда и: рақам = 0; и < ин.корбарон.дарозӣ; и++) {
            чоп.сабт(`${и + 1}. `);
            ин.корбарон[и].намоиш();
        }
    }

    ҷамъиятӣ гирифтани_шумора(): рақам {
        бозгашт ин.корбарон.дарозӣ;
    }
}
```

```somonscript
// main.som
ворид { Корбар, Идоракунандаи_корбарон } аз "./user-manager.som";

тағйирёбанда идоракунанда = нав Идоракунандаи_корбарон();

тағйирёбанда корбар1 = нав Корбар("Аҳмад", "ahmad@example.com", 25);
тағйирёбанда корбар2 = нав Корбар("Фотима", "fatima@example.com", 22);

идоракунанда.илова_кардан(корбар1);
идоракунанда.илова_кардан(корбар2);

идоракунанда.намоиш();
чоп.сабт(`\nШумораи корбарон: ${идоракунанда.гирифтани_шумора()}`);
```

## 9.5. Фармонҳои CLI барои модулҳо

### Компилятсияи модул

```bash
somon compile main.som
```

### Бастабандии модулҳо

```bash
somon bundle main.som -o dist/app.js
```

### Маълумот дар бораи модулҳо

```bash
somon module-info main.som --graph
```

### Ҳалли масири модул

```bash
somon resolve "./utils" --from main.som
```

## 9.6. Сохтори лоиҳа

Лоиҳаи хуби SomonScript мумкин аст чунин сохтор дошта бошад:

```
мої_лоиҳа/
├── src/
│   ├── main.som
│   ├── utils/
│   │   ├── math.som
│   │   ├── array-utils.som
│   │   └── string-utils.som
│   └── models/
│       ├── user.som
│       └── product.som
├── dist/
│   └── app.js
├── package.json
└── somon.config.json
```

## 9.7. Танзими системаи модулҳо

Файли `somon.config.json`:

```json
{
  "compilerOptions": {
    "target": "es2020",
    "sourceMap": true
  },
  "moduleSystem": {
    "resolution": {
      "baseUrl": ".",
      "extensions": [".som", ".js"]
    },
    "loading": {
      "circularDependencyStrategy": "warn"
    }
  },
  "bundle": {
    "format": "commonjs",
    "minify": false
  }
}
```

## 9.8. Хулоса

Дар ин боб шумо омӯхтед:
- Чӣ тавр кодро содир кардан (export)
- Чӣ тавр модулҳоро ворид кардан (import)
- Усулҳои гуногуни ворид/содир
- Ташкили лоиҳа бо модулҳо
- Фармонҳои CLI барои кор бо модулҳо

---

**Машқҳо:**

1. Модуле эҷод кунед, ки функсияҳои коркарди сатрҳоро дорад (калон кардан, хурд кардан, ҷойивазкунӣ)
2. Системаи модулҳо барои идораи китобхона созед (модулҳои Китоб, Муаллиф, Китобхона)
3. Модули математикии мукаммал эҷод кунед бо функсияҳои тригонометрия ва геометрия
4. Лоиҳае бо чанд модул созед ва онро бо `somon bundle` баста кунед
