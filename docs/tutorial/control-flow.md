# Control Flow

Master conditional statements, loops, and control flow patterns in SomonScript
to create dynamic and responsive programs.

## Conditional Statements

### Basic If Statement

```somon
тағйирёбанда синну_сол = 20;

агар (синну_сол >= 18) {
    чоп.сабт("Шумо калонсол ҳастед");
}
```

### If-Else Statement

```somon
тағйирёбанда синну_сол = 16;

агар (синну_сол >= 18) {
    чоп.сабт("Шумо метавонед ранғзанӣ кунед");
} вагарна {
    чоп.сабт("Шумо то ҳанӯз хурдсол ҳастед");
}
```

### Multiple Conditions with Else-If

```somon
тағйирёбанда бахо = 85;

агар (бахо >= 90) {
    чоп.сабт("Баҳои аъло!");
} вагарна агар (бахо >= 80) {
    чоп.сабт("Баҳои хуб!");
} вагарна агар (бахо >= 70) {
    чоп.сабт("Баҳои қаноатбахш");
} вагарна агар (бахо >= 60) {
    чоп.сабт("Гузариш");
} вагарна {
    чоп.сабт("Нагузашта");
}
```

## Comparison Operators

### Basic Comparisons

```somon
тағйирёбанда а = 10;
тағйирёбанда б = 5;

// Equality
агар (а == б) {
    чоп.сабт("а ва б баробар");
}

// Inequality
агар (а != б) {
    чоп.сабт("а ва б баробар нестанд");
}

// Greater than / Less than
агар (а > б) {
    чоп.сабт("а аз б калонтар");
}

агар (б < а) {
    чоп.сабт("б аз а хurdтар");
}

// Greater than or equal / Less than or equal
агар (а >= 10) {
    чоп.сабт("а аз 10 калонтар ё баробар");
}

агар (б <= 10) {
    чоп.сабт("б аз 10 хurдтар ё баробар");
}
```

### String Comparisons

```somon
тағйирёбанда ном1 = "Аҳмад";
тағйирёбанда ном2 = "Алӣ";

агар (ном1 == ном2) {
    чоп.сабт("Номҳо якхела");
} вагарна {
    чоп.сабт("Номҳо гуногун");
}

// Case-sensitive comparison
тағйирёбанда паём1 = "Салом";
тағйирёбанда паём2 = "салом";

агар (паём1 == паём2) {
    чоп.сабт("Паёмҳо якхела");
} вагарна {
    чоп.сабт("Паёмҳо гуногун (ҳуруфҳои калу-хурд фарқ мекунанд)");
}
```

## Logical Operators

### AND Operator (&&)

```somon
тағйирёбанда синну_сол = 25;
тағйирёбанда дорои_лисензия = дуруст;

агар (синну_сол >= 18 && дорои_лисензия) {
    чоп.сабт("Шумо метавонед мошин ронед");
} вагарна {
    чоп.сабт("Шумо наметавонед мошин ронед");
}
```

### OR Operator (||)

```somon
тағйирёбанда рӯзи_ҳафта = "шанбе";

агар (рӯзи_ҳафта == "шанбе" || рӯзи_ҳафта == "якшанбе") {
    чоп.сабт("Имрӯз рӯзи истироҳат");
} вагарна {
    чоп.сабт("Имрӯз рӯзи корӣ");
}
```

### NOT Operator (!)

```somon
тағйирёбанда барон_мебарад = нодуруст;

агар (!барон_мебарад) {
    чоп.сабт("Ҳаво хуб аст, метавонем баромад");
} вагарна {
    чоп.сабт("Барон мебарад, дар хона монем");
}
```

### Complex Logical Expressions

```somon
тағйирёбанда синну_сол = 22;
тағйирёбанда донишҷӯ = дуруст;
тағйирёбанда даромад = 1500;

агар ((синну_сол >= 18 && синну_сол <= 25) && (донишҷӯ || даромад < 2000)) {
    чоп.сабт("Шумо барои тахфиф лоиқ ҳастед");
} вагарна {
    чоп.сабт("Шумо барои тахфиф лоиқ нестед");
}
```

## Switch Statement (Match Expression)

### Basic Switch

```somon
тағйирёбанда рӯз = "душанбе";

муқоиса (рӯз) {
    ҳолат "душанбе":
        чоп.сабт("Оғози ҳафтаи корӣ");
        шикастан;
    ҳолат "ҷумъа":
        чоп.сабт("Охири ҳафтаи корӣ");
        шикастан;
    ҳолат "шанбе":
    ҳолат "якшанбе":
        чоп.сабт("Рӯзи истироҳат");
        шикастан;
    пешфарз:
        чоп.сабт("Рӯзи корӣ");
}
```

### Switch with Numbers

```somon
тағйирёбанда моҳ = 3;

муқоиса (моҳ) {
    ҳолат 12:
    ҳолат 1:
    ҳолат 2:
        чоп.сабт("Зимистон");
        шикастан;
    ҳолат 3:
    ҳолат 4:
    ҳолат 5:
        чоп.сабт("Баҳор");
        шикастан;
    ҳолат 6:
    ҳолат 7:
    ҳолат 8:
        чоп.сабт("Тобистон");
        шикастан;
    ҳолат 9:
    ҳолат 10:
    ҳолат 11:
        чоп.сабт("Тирамоҳ");
        шикастан;
    пешфарз:
        чоп.сабт("Моҳи номаълум");
}
```

## Loops

### While Loop

```somon
// Basic while loop
тағйирёбанда ҳисоб = 1;

то (ҳисоб <= 5) {
    чоп.сабт("Рақам: " + ҳисоб);
    ҳисоб = ҳисоб + 1;
}
// Output: 1, 2, 3, 4, 5
```

### Do-While Loop (Repeat-Until)

```somon
// Do-while equivalent
тағйирёбанда рақам = 1;

такрор {
    чоп.сабт("Рақам: " + рақам);
    рақам++;
} то (рақам <= 3);
// Output: 1, 2, 3
```

### For Loop

```somon
// Basic for loop
барои (тағйирёбанда и = 0; и < 5; и++) {
    чоп.сабт("Итератсия: " + и);
}
// Output: 0, 1, 2, 3, 4

// Counting backwards
барои (тағйирёбанда и = 5; и > 0; и--) {
    чоп.сабт("Ҳисоб: " + и);
}
// Output: 5, 4, 3, 2, 1

// Custom increment
барои (тағйирёбанда и = 0; и <= 10; и += 2) {
    чоп.сабт("Рақами ҷуфт: " + и);
}
// Output: 0, 2, 4, 6, 8, 10
```

### For-In Loop (Object Properties)

```somon
тағйирёбанда шахс = {
    ном: "Аҳмад",
    синну_сол: 25,
    шаҳр: "Душанбе"
};

барои (тағйирёбанда калид дар шахс) {
    чоп.сабт(калид + ": " + шахс[калид]);
}
// Output: ном: Аҳмад, синну_сол: 25, шаҳр: Душанбе
```

### For-Of Loop (Array Elements)

```somon
тағйирёбанда мевањо = ["себ", "банан", "гелос", "ангур"];

барои (тағйирёбанда мева аз мевањо) {
    чоп.сабт("Ман " + мева + " дӯст дорам");
}
// Output: Ман себ дӯст дорам, Ман банан дӯст дорам, etc.

// With index
барои (тағйирёбанда [индекс, мева] аз мевањо.entries()) {
    чоп.сабт(индекс + ": " + мева);
}
// Output: 0: себ, 1: банан, 2: гелос, 3: ангур
```

## Loop Control

### Break Statement

```somon
// Break out of loop early
барои (тағйирёбанда и = 1; и <= 10; и++) {
    агар (и == 5) {
        чоп.сабт("Ба рақами 5 расидем, давр қатъ мешавад");
        шикастан;
    }
    чоп.сабт("Рақам: " + и);
}
// Output: 1, 2, 3, 4, then breaks
```

### Continue Statement

```somon
// Skip current iteration
барои (тағйирёбанда и = 1; и <= 5; и++) {
    агар (и == 3) {
        чоп.сабт("Рақами 3 ро нодида мегирем");
        давом;
    }
    чоп.сабт("Рақам: " + и);
}
// Output: 1, 2, (skips 3), 4, 5
```

### Labeled Breaks

```somon
баромад: барои (тағйирёбанда и = 1; и <= 3; и++) {
    барои (тағйирёбанда ҷ = 1; ҷ <= 3; ҷ++) {
        агар (и == 2 && ҷ == 2) {
            чоп.сабт("Аз давري аслӣ мебарояд");
            шикастан баромад;
        }
        чоп.сабт("и=" + и + ", ҷ=" + ҷ);
    }
}
```

## Nested Loops

### Two-Dimensional Processing

```somon
// Creating a multiplication table
барои (тағйирёбанда и = 1; и <= 5; и++) {
    тағйирёбанда сатр = "";
    барои (тағйирёбанда ҷ = 1; ҷ <= 5; ҷ++) {
        сатр += (и * ҷ) + "\t";
    }
    чоп.сабт(сатр);
}
```

### Matrix Operations

```somon
тағйирёбанда матрица = [
    [1, 2, 3],
    [4, 5, 6],
    [7, 8, 9]
];

// Process each element
барои (тағйирёбанда и = 0; и < матрица.дарозӣ; и++) {
    барои (тағйирёбанда ҷ = 0; ҷ < матрица[и].дарозӣ; ҷ++) {
        чоп.сабт("Элемент [" + и + "][" + ҷ + "] = " + матрица[и][ҷ]);
    }
}
```

## Conditional Expressions (Ternary Operator)

### Basic Ternary

```somon
тағйирёбанда синну_сол = 20;
тағйирёбанда категория = синну_сол >= 18 ? "калонсол" : "хурдсол";
чоп.сабт("Шумо " + категория + " ҳастед");
```

### Nested Ternary

```somon
тағйирёбанда бахо = 85;
тағйирёбанда дараҷа = бахо >= 90 ? "А" :
                      бахо >= 80 ? "Б" :
                      бахо >= 70 ? "В" : "Г";
чоп.сабт("Дараҷаи шумо: " + дараҷа);
```

## Error Handling in Control Flow

### Try-Catch-Finally

```somon
функсия тақсими_бехатар(а: рақам, б: рақам): рақам | холӣ {
    кӯшиш {
        агар (б === 0) {
            партофтан нав Error("Ба сифр тақсим кардан мумкин нест");
        }
        бозгашт а / б;
    } гирифтан (хато) {
        чоп.хато("Хато рӯй дод: " + хато.паём);
        бозгашт холӣ;
    } ниҳоят {
        чоп.сабт("Амалиёти тақсим анҷом ёфт");
    }
}

тағйирёбанда натиҷа1 = тақсими_бехатар(10, 2);  // 5
тағйирёбанда натиҷа2 = тақсими_бехатар(10, 0);  // холӣ (with error)
```

### Multiple Catch Blocks

```somon
кӯшиш {
    // Risky operations
    тағйирёбанда маълумот = JSON.parse(invalidJSON);
    тағйирёбанда натиҷа = маълумот.ҳисоб / 0;
} гирифтан (хато) агар (хато instanceof SyntaxError) {
    чоп.хато("JSON нодуруст аст: " + хато.паём);
} гирифтан (хато) агар (хато instanceof TypeError) {
    чоп.хато("Хатои навъ: " + хато.паём);
} гирифтан (хато) {
    чоп.хато("Хатои умумӣ: " + хато.паём);
} ниҳоят {
    чоп.сабт("Тозакунии ресурсҳо");
}
```

## Advanced Control Flow Patterns

### Early Return Pattern

```somon
функсия санҷиши_корбар(корбар: Корбар): мантиқӣ {
    // Early returns for validation
    агар (!корбар) {
        бозгашт нодуруст;
    }

    агар (!корбар.ном || корбар.ном.дарозии_сатр < 2) {
        бозгашт нодуруст;
    }

    агар (корбар.синну_сол < 18) {
        бозгашт нодуруст;
    }

    // All validations passed
    бозгашт дуруст;
}
```

### State Machine Pattern

```somon
enum ҳолати_замима {
    ОҒОЗ = "оғоз",
    БОРИШ = "бориш",
    КОРМАРДИКУНӢ = "кормардикунӣ",
    ХАТМ = "хатм",
    ХАТО = "хато"
}

функсия коркарди_ҳолат(ҳолати_ҷорӣ: ҳолати_замима, амал: сатр): ҳолати_замима {
    муқоиса (ҳолати_ҷорӣ) {
        ҳолат ҳолати_замима.ОҒОЗ:
            агар (амал === "бор") {
                бозгашт ҳолати_замима.БОРИШ;
            }
            шикастан;

        ҳолат ҳолати_замима.БОРИШ:
            агар (амал === "кормардикунӣ") {
                бозгашт ҳолати_замима.КОРМАРДИКУНӢ;
            } вагарна агар (амал === "хато") {
                бозгашт ҳолати_замима.ХАТО;
            }
            шикастан;

        ҳолат ҳолати_замима.КОРМАРДИКУНӢ:
            агар (амал === "хатм") {
                бозгашт ҳолати_замима.ХАТМ;
            }
            шикастан;

        пешфарз:
            бозгашт ҳолати_замима.ХАТО;
    }

    бозгашт ҳолати_ҷорӣ;
}
```

## Practical Examples

### Example 1: Input Validation

```somon
функсия эътибори_маълумоти_корбар(маълумот: МаълумотиКорбар): сатр[] {
    тағйирёбанда хатоҳо: сатр[] = [];

    // Name validation
    агар (!маълумот.ном || маълумот.ном.trim().дарозии_сатр < 2) {
        хатоҳо.илова("Ном бояд ақаллан 2 ҳарф дошта бошад");
    }

    // Age validation
    агар (маълумот.синну_сол < 0 || маълумот.синну_сол > 150) {
        хатоҳо.илова("Синну сол бояд байни 0 то 150 бошад");
    }

    // Email validation
    агар (маълумот.email && !маълумот.email.includes("@")) {
        хатоҳо.илова("Email нодуруст аст");
    }

    бозгашт хатоҳо;
}
```

### Example 2: Menu System

```somon
функсия менюи_асосӣ(): шумораи_интихоб {
    то (дуруст) {
        чоп.сабт("\n--- Менюи асосӣ ---");
        чоп.сабт("1. Эҷоди корбари нав");
        чоп.сабт("2. Дидани рӯйхати корбарон");
        чоп.сабт("3. Тағйир додани корбар");
        чоп.сабт("4. Хориҷ");

        тағйирёбанда интихоб = parseInt(prompt("Интихоби худро ворид кунед: "));

        муқоиса (интихоб) {
            ҳолат 1:
                эҷоди_корбари_нав();
                шикастан;
            ҳолат 2:
                намоиши_рӯйхати_корбарон();
                шикастан;
            ҳолат 3:
                тағйири_корбар();
                шикастан;
            ҳолат 4:
                чоп.сабт("Хайрухуш!");
                бозгашт;
            пешфарз:
                чоп.сабт("Интихоби номаълум. Лутфан дубора кӯшиш кунед.");
        }
    }
}
```

### Example 3: Data Processing Pipeline

```somon
функсия коркарди_маълумоти_фурӯш(маълумот: МаълумотиХом[]): НатиҷаиКоркард {
    тағйирёбанда натиҷа = {
        муваффақ: 0,
        нобарор: 0,
        хатоҳо: []
    };

    барои (тағйирёбанда [индекс, қайд] аз маълумот.entries()) {
        кӯшиш {
            // Validate record
            агар (!қайд.сана || !қайд.миқдор || !қайд.маҳсулот) {
                партофтан нав Error("Маълумоти зарурӣ мавҷуд нест");
            }

            // Process valid record
            агар (қайд.миқдор > 0) {
                коркарди_фурӯши_муваффақ(қайд);
                натиҷа.муваффақ++;
            } вагарна {
                натиҷа.нобарор++;
            }

        } гирифтан (хато) {
            натиҷа.хатоҳо.илова({
                сатр: индекс + 1,
                паём: хато.паём,
                маълумот: қайд
            });
        }
    }

    бозгашт натиҷа;
}
```

## Best Practices

### 1. Use Clear Conditions

```somon
// ✅ Good: Clear, readable conditions
агар (корбар.синну_сол >= ҲАДДИ_АҚҚАЛИ_СИННУ_СОЛ && корбар.тасдиқшуда) {
    иҷозаи_дастрасӣ();
}

// ❌ Avoid: Unclear magic numbers
агар (корбар.синну_сол >= 18 && корбар.статус == 1) {
    иҷозаи_дастрасӣ();
}
```

### 2. Minimize Nested Conditions

```somon
// ✅ Good: Early returns reduce nesting
функсия коркарди_дархост(дархост: Дархост): Натиҷа {
    агар (!дархост) {
        бозгашт "Дархост мавҷуд нест";
    }

    агар (!дархост.эътибор) {
        бозгашт "Дархост нодуруст аст";
    }

    // Main processing logic
    бозгашт коркарди_асосӣ(дархост);
}
```

### 3. Use Appropriate Loop Types

```somon
// ✅ Good: Use for-of for arrays
барои (тағйирёбанда элемент аз массив) {
    коркарди_элемент(элемент);
}

// ✅ Good: Use for-in for object properties
барои (тағйирёбанда калид дар объект) {
    коркарди_хусусият(калид, объект[калид]);
}

// ✅ Good: Use while for conditions
то (шарти_давом()) {
    анҷоми_амал();
}
```

## Next Steps

Now that you understand control flow, continue with:

1. **[Classes and Objects](classes-and-objects.md)** - Object-oriented
   programming
2. **[Advanced Types](advanced-types.md)** - Union types, generics, and more
3. **[Reference - Control Flow](../reference/conditionals.md)** - Complete
   control flow reference

---

**Ready for OOP?** → [Classes and Objects](classes-and-objects.md)
