# SonarCloud Configuration - MASTER FILE
# This file takes ABSOLUTE PRECEDENCE over sonar-project.properties
# Purpose: Ensure ZERO test files are analyzed by SonarCloud

# ============================================================================
# WHITELIST APPROACH: Only scan src/ directory
# ============================================================================
sonar.sources=src
sonar.inclusions=src/**/*.ts

# DO NOT mark tests as test sources - this causes them to be scanned
# sonar.tests is intentionally OMITTED

# ============================================================================
# EXCLUSIONS: Multiple layers of defense
# ============================================================================

# Primary exclusions - exclude from ALL analysis
sonar.exclusions=\
  tests/**,\
  tests/**/*,\
  tests/**/**,\
  tests/**/*.ts,\
  tests/**/*.js,\
  **/tests/**,\
  **/*.test.ts,\
  **/*.spec.ts,\
  **/*.test.js,\
  **/*.spec.js,\
  **/test-*.ts,\
  **/test-*.js,\
  tests/helpers/**,\
  tests/helpers/*.ts,\
  **/helpers/test-utils.ts,\
  dist/**,\
  coverage/**,\
  node_modules/**,\
  examples/**,\
  scripts/**,\
  **/*.d.ts,\
  build/**,\
  .github/**

# Test-specific exclusions
sonar.test.exclusions=tests/**,**/*.test.ts,**/*.spec.ts

# Coverage exclusions
sonar.coverage.exclusions=\
  tests/**,\
  tests/**/*,\
  **/*.test.ts,\
  **/*.spec.ts,\
  **/test-*.ts

# Duplication exclusions
sonar.cpd.exclusions=\
  tests/**,\
  tests/**/*,\
  **/*.test.ts,\
  **/*.spec.ts

# Security analysis exclusions
sonar.security.exclusions=\
  tests/**,\
  tests/**/*,\
  tests/**/*.ts,\
  **/*.test.ts,\
  **/*.spec.ts,\
  tests/production-validation.test.ts,\
  tests/cli-production-mode.test.ts,\
  tests/helpers/test-utils.ts

# Global exclusions
sonar.global.exclusions=tests/**,**/*.test.ts,**/*.spec.ts

# SCM exclusions
sonar.scm.exclusions=tests/**

# ============================================================================
# ISSUE IGNORE RULES: Nuclear option - ignore ALL issues in test files
# ============================================================================
sonar.issue.ignore.multicriteria=e1,e2,e3,e4,e5,e6,e7,e8,e9,e10

# e1: Ignore ALL rules for tests/** directory (any depth)
sonar.issue.ignore.multicriteria.e1.ruleKey=*
sonar.issue.ignore.multicriteria.e1.resourceKey=tests/**

# e2: Ignore ALL rules for **/*.test.ts
sonar.issue.ignore.multicriteria.e2.ruleKey=*
sonar.issue.ignore.multicriteria.e2.resourceKey=**/*.test.ts

# e3: Ignore ALL rules for **/*.spec.ts
sonar.issue.ignore.multicriteria.e3.ruleKey=*
sonar.issue.ignore.multicriteria.e3.resourceKey=**/*.spec.ts

# e4: Specifically ignore typescript:S4036 (PATH security hotspot)
sonar.issue.ignore.multicriteria.e4.ruleKey=typescript:S4036
sonar.issue.ignore.multicriteria.e4.resourceKey=tests/**

# e5: Ignore all TypeScript security hotspots (S*) in tests
sonar.issue.ignore.multicriteria.e5.ruleKey=typescript:S*
sonar.issue.ignore.multicriteria.e5.resourceKey=tests/**

# e6: Ignore all javascript security hotspots in tests
sonar.issue.ignore.multicriteria.e6.ruleKey=javascript:S*
sonar.issue.ignore.multicriteria.e6.resourceKey=tests/**

# e7: Explicitly ignore tests/production-validation.test.ts
sonar.issue.ignore.multicriteria.e7.ruleKey=*
sonar.issue.ignore.multicriteria.e7.resourceKey=tests/production-validation.test.ts

# e8: Explicitly ignore tests/cli-production-mode.test.ts
sonar.issue.ignore.multicriteria.e8.ruleKey=*
sonar.issue.ignore.multicriteria.e8.resourceKey=tests/cli-production-mode.test.ts

# e9: Explicitly ignore test helpers
sonar.issue.ignore.multicriteria.e9.ruleKey=*
sonar.issue.ignore.multicriteria.e9.resourceKey=tests/helpers/**

# e10: Ignore all rules in any file under **/tests/** (catch-all)
sonar.issue.ignore.multicriteria.e10.ruleKey=*
sonar.issue.ignore.multicriteria.e10.resourceKey=**/tests/**

# ============================================================================
# ADDITIONAL SAFEGUARDS
# ============================================================================

# Skip scanning these directories entirely
sonar.skip.patterns=tests/**,tests/**/*,tests/**/*.ts,coverage/**,dist/**

# Ignore all issues from any path containing "test"
sonar.issue.ignore.allfile=true
