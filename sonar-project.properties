# SonarQube Project Configuration for SomonScript
# Note: .sonarcloud.properties takes precedence for SonarCloud scans

# ============================================================================
# Project Identification
# ============================================================================
sonar.projectKey=lindentech_somon-script
sonar.organization=lindentech
sonar.projectName=Somon-Script
sonar.projectVersion=0.3.47

# ============================================================================
# Source Configuration
# ============================================================================

# ONLY analyze src directory - NEVER tests
sonar.sources=src

# Explicitly include ONLY TypeScript files in src
sonar.inclusions=src/**/*.ts

# ============================================================================
# Test File Exclusions (Multi-layered Defense)
# ============================================================================

# Primary exclusions - comprehensive patterns
sonar.exclusions=\
  tests/**,\
  tests/**/*,\
  tests/**/**,\
  tests/**/*.ts,\
  **/tests/**,\
  **/*.test.ts,\
  **/*.spec.ts,\
  **/test-*.ts,\
  tests/helpers/**,\
  tests/helpers/*.ts,\
  **/helpers/test-utils.ts,\
  tests/production-validation.test.ts,\
  tests/cli-production-mode.test.ts,\
  dist/**,\
  coverage/**,\
  node_modules/**,\
  examples/**,\
  scripts/**,\
  **/*.d.ts

# Test exclusions
sonar.test.exclusions=tests/**,**/*.test.ts,**/*.spec.ts

# Coverage exclusions
sonar.coverage.exclusions=\
  tests/**,\
  tests/**/*,\
  tests/**/*.ts,\
  **/*.test.ts,\
  **/*.spec.ts

# Duplication exclusions
sonar.cpd.exclusions=\
  tests/**,\
  tests/**/*,\
  tests/**/*.ts,\
  **/*.test.ts,\
  **/*.spec.ts

# Security hotspot exclusions
sonar.security.exclusions=\
  tests/**,\
  tests/**/*,\
  tests/**/*.ts,\
  **/*.test.ts,\
  **/*.spec.ts,\
  tests/production-validation.test.ts,\
  tests/cli-production-mode.test.ts

# Global exclusions
sonar.global.exclusions=tests/**,**/*.test.ts

# SCM exclusions
sonar.scm.exclusions=tests/**

# Skip patterns
sonar.skip.patterns=tests/**,tests/**/*,tests/**/*.ts

# ============================================================================
# Issue Ignore Rules - Suppress ALL issues in test files
# ============================================================================
sonar.issue.ignore.multicriteria=e1,e2,e3,e4,e5,e6,e7,e8

# e1: Ignore all issues in tests/** directory
sonar.issue.ignore.multicriteria.e1.ruleKey=*
sonar.issue.ignore.multicriteria.e1.resourceKey=tests/**

# e2: Ignore all issues in **/*.test.ts files
sonar.issue.ignore.multicriteria.e2.ruleKey=*
sonar.issue.ignore.multicriteria.e2.resourceKey=**/*.test.ts

# e3: Ignore all issues in **/*.spec.ts files
sonar.issue.ignore.multicriteria.e3.ruleKey=*
sonar.issue.ignore.multicriteria.e3.resourceKey=**/*.spec.ts

# e4: Specifically ignore S4036 (PATH security) in tests
sonar.issue.ignore.multicriteria.e4.ruleKey=typescript:S4036
sonar.issue.ignore.multicriteria.e4.resourceKey=tests/**

# e5: Ignore all TypeScript security rules in tests
sonar.issue.ignore.multicriteria.e5.ruleKey=typescript:S*
sonar.issue.ignore.multicriteria.e5.resourceKey=tests/**

# e6: Ignore all issues in tests/production-validation.test.ts
sonar.issue.ignore.multicriteria.e6.ruleKey=*
sonar.issue.ignore.multicriteria.e6.resourceKey=tests/production-validation.test.ts

# e7: Ignore all issues in tests/cli-production-mode.test.ts
sonar.issue.ignore.multicriteria.e7.ruleKey=*
sonar.issue.ignore.multicriteria.e7.resourceKey=tests/cli-production-mode.test.ts

# e8: Ignore all issues in **/tests/** (catch-all)
sonar.issue.ignore.multicriteria.e8.ruleKey=*
sonar.issue.ignore.multicriteria.e8.resourceKey=**/tests/**

# ============================================================================
# Analysis Settings
# ============================================================================

# TypeScript/JavaScript specific
sonar.javascript.lcov.reportPaths=coverage/lcov.info
sonar.typescript.lcov.reportPaths=coverage/lcov.info

# Source encoding
sonar.sourceEncoding=UTF-8

# Language-specific file suffixes
sonar.typescript.file.suffixes=.ts
sonar.javascript.file.suffixes=.js

# Duplication detection
sonar.cpd.ts.minimumTokens=50
sonar.cpd.js.minimumTokens=50

# Code complexity (aligned with ESLint)
sonar.typescript.complexity.threshold=15
